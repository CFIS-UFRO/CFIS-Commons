#!/bin/bash
# --------------------------------------------------------------------------------------------------
# Pre-commit hook to auto-generate version based on commit timestamp
#
# NOTE ABOUT CROSS-PLATFORM COMPATIBILITY:
# This script works on all operating systems (Linux, macOS, Windows) because:
# - Git for Windows includes Git Bash (MINGW64) with all necessary commands
# - The hook is automatically executed by Git in the bash environment
# --------------------------------------------------------------------------------------------------
# To use this hook:
# 1. Save this script in any folder in your repo, e.g., hooks/pre-commit
# 2. Make it executable: chmod +x hooks/pre-commit
# 3. Configure Git to use it: git config core.hooksPath hooks/
# 4. Commit as usual, and the version.py file will be auto-updated
# --------------------------------------------------------------------------------------------------

# Get current UTC timestamp in format: YY.MM.DD.HHmm
VERSION=$(date -u +"%y.%m.%d.%H%M")

# Path to version file (relative to repo root)
VERSION_FILE="version.py"

# Generate version.py content
cat > "$VERSION_FILE" << EOF
#!/usr/bin/env python3
# --------------------------------------------------------------------------------------------------
# Auto-generated version file - DO NOT EDIT MANUALLY
# This file is automatically generated by the pre-commit hook based on the last commit timestamp
# --------------------------------------------------------------------------------------------------

__version__ = "$VERSION"
EOF

# Add the updated version file to the commit
git add "$VERSION_FILE"

echo "Version auto-generated: $VERSION"
